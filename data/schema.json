{
  "$id": "https://your-domain/schemas/results-dashboard.json",
  "type": "object",
  "required": ["userId", "generatedAt", "currency", "personality", "recommendedPaths"],
  "properties": {
    "userId": { "type": "string" },
    "generatedAt": { "type": "string", "format": "date-time" },
    "locale": { "type": "string" },
    "currency": { "type": "string" },
    "personality": {
      "type": "object",
      "required": ["model", "scores", "topDimensions", "summary", "tags", "provenance"],
      "properties": {
        "model": { "const": "RIASEC" },
        "scores": {
          "type": "object",
          "required": ["R","I","A","S","E","C"],
          "properties": {
            "R": { "type": "number" }, "I": { "type": "number" },
            "A": { "type": "number" }, "S": { "type": "number" },
            "E": { "type": "number" }, "C": { "type": "number" }
          },
          "additionalProperties": false
        },
        "topDimensions": { "type": "array", "items": { "enum": ["R","I","A","S","E","C"] } },
        "summary": { "type": "string" },
        "tags": { "type": "array", "items": { "type": "string" } },
        "evidence": {
          "type": "object",
          "properties": {
            "fromOnboarding": { "type": "array", "items": { "type": "string" } },
            "fromResume": { "type": "array", "items": { "type": "string" } }
          },
          "additionalProperties": false
        },
        "provenance": { "$ref": "#/$defs/provenance" }
      },
      "additionalProperties": false
    },
    "recommendedPaths": {
      "type": "array",
      "minItems": 1,
      "maxItems": 3,
      "items": { "$ref": "#/$defs/careerPathCard" }
    }
  },
  "$defs": {
    "provenance": {
      "type": "object",
      "required": ["generatedBy", "createdAt"],
      "properties": {
        "generatedBy": { "enum": ["llm", "etl", "manual"] },
        "model": { "type": "string" },
        "promptHash": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" },
        "sources": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "name"],
            "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "url": { "type": "string" },
              "dataset": { "type": "string" },
              "retrievedAt": { "type": "string", "format": "date-time" },
              "notes": { "type": "string" }
            },
            "additionalProperties": false
          }
        },
        "confidence": { "type": "number" }
      },
      "additionalProperties": false
    },
    "onetRef": {
      "type": "object",
      "required": ["socCode", "title"],
      "properties": {
        "socCode": { "type": "string" },
        "onetId": { "type": "string" },
        "title": { "type": "string" }
      },
      "additionalProperties": false
    },
    "careerPathCard": {
      "type": "object",
      "required": ["id","occupation","matchScore","tagsMatched","potentialSalaryAfter","shortSummary"],
      "properties": {
        "id": { "type": "string" },
        "occupation": { "$ref": "#/$defs/onetRef" },
        "matchScore": { "type": "number" },
        "tagsMatched": { "type": "array", "items": { "type": "string" } },
        "potentialSalaryAfter": {
          "type": "object",
          "required": ["timeHorizonMonths","amount","currency"],
          "properties": {
            "timeHorizonMonths": { "type": "integer" },
            "amount": { "type": "number" },
            "currency": { "type": "string" },
            "percentiles": {
              "type": "object",
              "properties": {
                "10": { "type": "number" },
                "25": { "type": "number" },
                "50": { "type": "number" },
                "75": { "type": "number" },
                "90": { "type": "number" }
              },
              "additionalProperties": false
            },
            "notes": { "type": "string" },
            "provenance": { "$ref": "#/$defs/provenance" }
          },
          "additionalProperties": false
        },
        "shortSummary": { "type": "string" },
        "miniDemand": {
          "type": "object",
          "properties": {
            "unit": { "type": "string" },
            "seriesType": { "enum": ["observed","forecast"] },
            "points": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["date","value"],
                "properties": {
                  "date": { "type": "string", "format": "date" },
                  "value": { "type": "number" },
                  "reasoning": { "type": "string" }
                },
                "additionalProperties": false
              }
            },
            "lastObserved": { "type": "number" },
            "lastForecast": { "type": "number" }
          },
          "additionalProperties": false
        },
        "details": { "$ref": "#/$defs/careerPathDetails" }
      },
      "additionalProperties": false
    },
    "careerPathDetails": {
      "type": "object",
      "required": ["title","summary","demandForecasts","payScale","testimonials","journey","resources"],
      "properties": {
        "title": { "type": "string" },
        "summary": { "type": "string" },
        "demandForecasts": { "$ref": "#/$defs/demandBlock" },
        "payScale": { "$ref": "#/$defs/payScaleBlock" },
        "testimonials": {
          "type": "object",
          "properties": {
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["id","authorDisplay","quote","isPlaceholder"],
                "properties": {
                  "id": { "type": "string" },
                  "authorDisplay": { "type": "string" },
                  "quote": { "type": "string" },
                  "isPlaceholder": { "type": "boolean" }
                },
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        },
        "journey": { "$ref": "#/$defs/journeyBlock" },
        "resources": {
          "type": "object",
          "properties": {
            "items": { "type": "array", "items": { "$ref": "#/$defs/resource" } }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "demandBlock": {
      "type": "object",
      "required": ["primaryUnit","observed","forecast"],
      "properties": {
        "primaryUnit": { "type": "string" },
        "observed": { "type": "array", "items": { "$ref": "#/$defs/timeSeries" } },
        "forecast": { "type": "array", "items": { "$ref": "#/$defs/timeSeries" } },
        "notes": { "type": "string" }
      },
      "additionalProperties": false
    },
    "timeSeries": {
      "type": "object",
      "required": ["unit","seriesType","points"],
      "properties": {
        "unit": { "type": "string" },
        "seriesType": { "enum": ["observed","forecast"] },
        "points": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["date","value"],
            "properties": {
              "date": { "type": "string", "format": "date" },
              "value": { "type": "number" },
              "reasoning": { "type": "string" }
            },
            "additionalProperties": false
          }
        },
        "source": { "$ref": "#/$defs/sourceRef" }
      },
      "additionalProperties": false
    },
    "payScaleBlock": {
      "type": "object",
      "properties": {
        "bands": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["yearsExperience","currency"],
            "properties": {
              "yearsExperience": { "type": "number" },
              "currency": { "type": "string" },
              "average": { "type": "number" },
              "low": { "type": "number" },
              "high": { "type": "number" },
              "source": { "$ref": "#/$defs/sourceRef" }
            },
            "additionalProperties": false
          }
        },
        "assumptions": { "type": "string" },
        "provenance": { "$ref": "#/$defs/provenance" }
      },
      "additionalProperties": false
    },
    "journeyBlock": {
      "type": "object",
      "required": ["currentProfile","steps"],
      "properties": {
        "currentProfile": {
          "type": "object",
          "required": ["summary"],
          "properties": {
            "summary": { "type": "string" },
            "resumeHighlights": { "type": "array", "items": { "type": "string" } },
            "education": { "type": "array", "items": { "type": "string" } },
            "skills": { "type": "array", "items": { "type": "string" } }
          },
          "additionalProperties": false
        },
        "steps": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id","title","description","category","provenance"],
            "properties": {
              "id": { "type": "string" },
              "title": { "type": "string" },
              "description": { "type": "string" },
              "category": { "type": "string" },
              "dueDate": { "type": "string", "format": "date" },
              "estHours": { "type": "number" },
              "dependencies": { "type": "array", "items": { "type": "string" } },
              "resourceRefs": { "type": "array", "items": { "type": "string" } },
              "completion": {
                "type": "object",
                "properties": {
                  "status": { "enum": ["not_started","in_progress","done","blocked"] },
                  "updatedAt": { "type": "string", "format": "date-time" }
                },
                "additionalProperties": false
              },
              "successCriteria": { "type": "string" },
              "provenance": { "$ref": "#/$defs/provenance" }
            },
            "additionalProperties": false
          }
        },
        "projections": {
          "type": "object",
          "properties": {
            "targetRole": { "$ref": "#/$defs/onetRef" },
            "targetDate": { "type": "string", "format": "date" },
            "expectedSalary": { "type": "number" },
            "currency": { "type": "string" },
            "notes": { "type": "string" }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "resource": {
      "type": "object",
      "required": ["id","type","title","url"],
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string" },
        "title": { "type": "string" },
        "url": { "type": "string" },
        "provider": { "type": "string" },
        "cost": { "type": "number" },
        "currency": { "type": "string" },
        "timeToCompleteHours": { "type": "number" },
        "level": { "type": "string" },
        "tags": { "type": "array", "items": { "type": "string" } },
        "source": { "$ref": "#/$defs/sourceRef" }
      },
      "additionalProperties": false
    },
    "sourceRef": {
      "type": "object",
      "required": ["id","name"],
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "url": { "type": "string" },
        "dataset": { "type": "string" },
        "retrievedAt": { "type": "string", "format": "date-time" },
        "notes": { "type": "string" }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}

